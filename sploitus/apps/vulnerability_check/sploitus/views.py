from django.shortcuts import render
from rest_framework.decorators import api_view
from rest_framework.response import Response
from . import tasks
from .sploitus import sploitus_parser

@api_view(['POST'])
def index(request):
    query = request.data.get("query")
    try:
        tasks.parse_query_task.delay(query)

        # results = sploitus_parser.parse(query)
        # print("RRRRRRESS: ", results)

        return Response({
            "status": 'in progress',
        })
    except Exception as e:
        return Response({
            "status": 'error',
        }, status=500)
